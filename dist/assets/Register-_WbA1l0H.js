import{j as e}from"./ui-BoKmkzIG.js";import{b as a,r as s,L as r}from"./vendor-C3gKaNvt.js";import{e as i,f as l,r as n,s as t,d as o}from"./firebase-BeVwnubw.js";import{a as d,d as m,f as c}from"./firebase-DRWWrR8x.js";const u=()=>{const u=a(),[h,p]=s.useState({name:"",email:"",password:"",confirmPassword:""}),[x,b]=s.useState(""),[f,g]=s.useState(!1),[k,w]=s.useState(!1);s.useEffect((()=>{if(c){w(!0);const e=o(d,(e=>{e&&u("/dashboard")}));return()=>e()}b("Firebase tidak terinitialisasi dengan benar. Harap refresh halaman atau hubungi administrator.")}),[u]);const j=e=>{p({...h,[e.target.name]:e.target.value}),x&&b("")};return e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx("div",{className:"flex flex-1 flex-col justify-center py-12 px-4 sm:px-6 lg:flex-none lg:px-20 xl:px-24",children:e.jsxs("div",{className:"mx-auto w-full max-w-sm lg:w-96",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Daftar Akun Baru"}),e.jsxs("p",{className:"mt-2 text-sm text-gray-600",children:["Atau"," ",e.jsx(r,{to:"/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"masuk jika sudah memiliki akun"})]})]}),e.jsx("div",{className:"mt-8",children:e.jsx("div",{className:"mt-6",children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),g(!0),b(""),console.log("Proses registrasi dimulai..."),!k)return b("Firebase tidak terinitialisasi dengan benar. Harap refresh halaman atau hubungi administrator."),void g(!1);if(!(h.name&&h.email&&h.password&&h.confirmPassword))return b("Semua kolom harus diisi"),void g(!1);if(h.password!==h.confirmPassword)return b("Password dan konfirmasi password tidak sama"),void g(!1);if(h.password.length<6)return b("Password minimal 6 karakter"),void g(!1);try{console.log("Mencoba membuat akun dengan Firebase..."),console.log("Auth objek tersedia:",!!d);const e=await i(d,h.email,h.password);console.log("Akun berhasil dibuat:",e);const a=e.user;console.log("Memperbarui profil dengan nama..."),await l(a,{displayName:h.name}),console.log("Menyimpan data pengguna ke database...");const s=n(m,`users/${a.uid}`);await t(s,{id:a.uid,username:h.name,email:h.email,score:0,createdAt:a.metadata.creationTime||(new Date).toISOString(),lastUpdated:(new Date).toISOString()}),console.log("Menyimpan progres awal pengguna...");const r={completedTopics:0,totalTopics:12,dailyStreak:1,xpPoints:50,rank:"Pemula",nextMilestone:200};localStorage.setItem("userProgress",JSON.stringify(r)),console.log("Menyimpan data pengguna di localStorage..."),localStorage.setItem("user",JSON.stringify({id:a.uid,email:h.email,name:h.name})),localStorage.setItem("token",a.accessToken),localStorage.setItem("userId",a.uid),console.log("Registrasi berhasil, mengarahkan ke dashboard..."),p({name:"",email:"",password:"",confirmPassword:""}),g(!1),u("/dashboard")}catch(a){console.error("Firebase Auth Error:",a),console.error("Error code:",a.code),console.error("Error message:",a.message);let e="Terjadi kesalahan saat pendaftaran. Silakan coba lagi.";switch(a.code){case"auth/email-already-in-use":e="Email sudah terdaftar. Silakan gunakan email lain.";break;case"auth/invalid-email":e="Format email tidak valid.";break;case"auth/operation-not-allowed":e="Operasi tidak diperbolehkan.";break;case"auth/weak-password":e="Password terlalu lemah. Gunakan kombinasi huruf, angka, dan simbol.";break;case"auth/network-request-failed":e="Koneksi internet bermasalah. Periksa koneksi internet Anda.";break;case"auth/invalid-api-key":case"auth/api-key-not-valid":e="Konfigurasi API tidak valid. Silakan hubungi administrator.";break;case"auth/app-deleted":e="Aplikasi Firebase tidak tersedia. Silakan hubungi administrator.";break;case"auth/argument-error":e="Terjadi kesalahan validasi input. Periksa kembali data yang dimasukkan.";break;default:e=`Terjadi kesalahan saat pendaftaran (${a.code}): ${a.message}`}b(e),g(!1)}},className:"space-y-6",children:[x&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-sm font-medium text-red-800",children:x})})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nama"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"name",name:"name",type:"text",autoComplete:"name",required:!0,value:h.name,onChange:j,className:"block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:h.email,onChange:j,className:"block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:h.password,onChange:j,className:"block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Konfirmasi Password"}),e.jsx("div",{className:"mt-1",children:e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,value:h.confirmPassword,onChange:j,className:"block w-full appearance-none rounded-md border border-gray-300 px-3 py-2 placeholder-gray-400 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"})})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:f||!k,className:"flex w-full justify-center rounded-md border border-transparent bg-blue-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-75",children:f?"Memproses...":"Daftar"})})]})})})]})}),e.jsx("div",{className:"relative hidden w-0 flex-1 lg:block",children:e.jsx("div",{className:"absolute inset-0 h-full w-full bg-gradient-to-r from-blue-800 to-blue-600 flex items-center justify-center",children:e.jsxs("div",{className:"px-8 text-center text-white",children:[e.jsx("h2",{className:"text-4xl font-bold mb-4",children:"Bergabunglah dengan Komunitas Belajar Kami"}),e.jsx("p",{className:"text-xl",children:"Tingkatkan kemampuan matematika Anda melalui metode belajar yang menyenangkan"})]})})})]})};export{u as default};
