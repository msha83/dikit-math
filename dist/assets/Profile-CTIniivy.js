import{j as e}from"./ui-BoKmkzIG.js";import{b as a,r as s,L as t}from"./vendor-C3gKaNvt.js";const l=()=>{const l=a(),[r,d]=s.useState("profile"),[i,n]=s.useState(null),[o,c]=s.useState(!0),[m,x]=s.useState({name:"",email:"",bio:"",school:"",grade:"",avatarUrl:""}),[h,u]=s.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[p,b]=s.useState({completedTopics:0,totalTopics:0,completedExercises:0,totalExercises:0,totalXP:0,dailyStreak:0,rank:"Pemula",nextRank:"Bintang",xpToNextRank:100,topicsCompleted:[],recentActivities:[]}),[g,j]=s.useState(!1),[v,y]=s.useState({type:"",text:""});s.useEffect((()=>{(async()=>{const e=localStorage.getItem("token"),a=localStorage.getItem("user");if(e&&a)try{const e=JSON.parse(a);n(e),x({name:e.name||"",email:e.email||"",bio:e.bio||"",school:e.school||"",grade:e.grade||"",avatarUrl:e.avatarUrl||`https://ui-avatars.com/api/?name=${encodeURIComponent(e.name||"User")}&background=random`}),f(e.id)}catch(s){console.error("Error loading user data:",s),l("/login")}finally{c(!1)}else l("/login")})()}),[l]);const f=e=>{setTimeout((()=>{const e={completedTopics:Math.floor(15*Math.random())+5,totalTopics:30,completedExercises:Math.floor(50*Math.random())+20,totalExercises:100,totalXP:Math.floor(1e3*Math.random())+500,dailyStreak:Math.floor(10*Math.random())+1,rank:"Bintang",nextRank:"Juara",xpToNextRank:Math.floor(200*Math.random())+50,topicsCompleted:[{id:1,name:"Persamaan Linear",date:"2023-10-15",xpEarned:50},{id:2,name:"Fungsi Kuadrat",date:"2023-10-10",xpEarned:75},{id:3,name:"Trigonometri Dasar",date:"2023-10-05",xpEarned:60}],recentActivities:[{id:1,type:"quiz",name:"Latihan Soal Persamaan Linear",date:"2023-10-20",result:"8/10"},{id:2,type:"flashcard",name:"Flashcard Logaritma",date:"2023-10-18",result:"Selesai"},{id:3,type:"material",name:"Belajar Materi Statistika",date:"2023-10-15",result:"Selesai"}]};b(e)}),800)},N=e=>{const{name:a,value:s}=e.target;x((e=>({...e,[a]:s})))},w=e=>{const{name:a,value:s}=e.target;u((e=>({...e,[a]:s})))},k=e=>{e.preventDefault(),c(!0),setTimeout((()=>{try{const e={...i,...m};localStorage.setItem("user",JSON.stringify(e)),n(e),j(!1),y({type:"success",text:"Profil berhasil diperbarui!"})}catch(e){y({type:"error",text:"Gagal memperbarui profil. Silakan coba lagi."})}finally{c(!1)}}),1e3)},P=e=>{e.preventDefault(),h.newPassword.length<6?y({type:"error",text:"Password baru minimal 6 karakter"}):h.newPassword===h.confirmPassword?(c(!0),setTimeout((()=>{try{y({type:"success",text:"Password berhasil diubah!"}),u({currentPassword:"",newPassword:"",confirmPassword:""})}catch(e){y({type:"error",text:"Gagal mengubah password. Silakan coba lagi."})}finally{c(!1)}}),1e3)):y({type:"error",text:"Password baru dan konfirmasi tidak sama"})};return o&&!i?e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Profil Saya"}),e.jsx("p",{className:"text-gray-600",children:"Kelola informasi profil dan preferensi pembelajaran Anda"})]}),v.text&&e.jsx("div",{className:"mb-4 p-3 rounded-md "+("success"===v.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:v.text}),e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden mb-8",children:[e.jsx("div",{className:"border-b",children:e.jsxs("nav",{className:"flex",children:[e.jsx("button",{onClick:()=>{d("profile"),y({type:"",text:""})},className:"px-6 py-4 text-sm font-medium "+("profile"===r?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Profil"}),e.jsx("button",{onClick:()=>{d("password"),y({type:"",text:""})},className:"px-6 py-4 text-sm font-medium "+("password"===r?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Ubah Password"}),e.jsx("button",{onClick:()=>{d("achievements"),y({type:"",text:""})},className:"px-6 py-4 text-sm font-medium "+("achievements"===r?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"),children:"Pencapaian"})]})}),e.jsxs("div",{className:"p-6",children:["profile"===r&&(g?e.jsx("form",{onSubmit:k,className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"md:w-1/3 flex flex-col items-center space-y-3",children:[e.jsx("img",{src:m.avatarUrl,alt:"Profile",className:"w-32 h-32 rounded-full border-4 border-blue-500 object-cover"}),e.jsxs("div",{className:"text-center",children:[e.jsx("input",{type:"text",name:"avatarUrl",value:m.avatarUrl,onChange:N,placeholder:"URL Avatar (opsional)",className:"mt-2 w-full px-3 py-2 border border-gray-300 rounded-md text-sm"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Masukkan URL gambar atau gunakan layanan UI Avatars"})]})]}),e.jsxs("div",{className:"md:w-2/3 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nama"}),e.jsx("input",{type:"text",name:"name",value:m.name,onChange:N,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:m.email,onChange:N,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Sekolah"}),e.jsx("input",{type:"text",name:"school",value:m.school,onChange:N,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Kelas"}),e.jsxs("select",{name:"grade",value:m.grade,onChange:N,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"Pilih Kelas"}),e.jsx("option",{value:"10",children:"Kelas 10"}),e.jsx("option",{value:"11",children:"Kelas 11"}),e.jsx("option",{value:"12",children:"Kelas 12"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Bio"}),e.jsx("textarea",{name:"bio",value:m.bio,onChange:N,rows:"3",className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"Ceritakan sedikit tentang dirimu..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>j(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700",disabled:o,children:o?"Menyimpan...":"Simpan Perubahan"})]})]})]})}):e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("div",{className:"md:w-1/3 flex flex-col items-center space-y-3",children:[e.jsx("img",{src:m.avatarUrl,alt:"Profile",className:"w-32 h-32 rounded-full border-4 border-blue-500 object-cover"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-bold text-xl",children:m.name}),e.jsx("p",{className:"text-gray-500",children:m.email})]})]}),e.jsxs("div",{className:"md:w-2/3 space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>j(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700",children:"Edit Profil"})}),e.jsxs("div",{className:"bg-white rounded-lg border p-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-500",children:"Sekolah"}),e.jsx("p",{className:"font-medium",children:m.school||"Belum diisi"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-500",children:"Kelas"}),e.jsx("p",{className:"font-medium",children:m.grade?`Kelas ${m.grade}`:"Belum diisi"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm text-gray-500",children:"Bio"}),e.jsx("p",{className:"font-medium",children:m.bio||"Belum ada bio"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-4",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Statistik Pembelajaran"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"font-bold text-blue-600 text-xl",children:[p.completedTopics,"/",p.totalTopics]}),e.jsx("div",{className:"text-gray-600 text-sm",children:"Topik Selesai"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"font-bold text-green-600 text-xl",children:[p.completedExercises,"/",p.totalExercises]}),e.jsx("div",{className:"text-gray-600 text-sm",children:"Latihan Soal"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsxs("div",{className:"font-bold text-purple-600 text-xl",children:[p.totalXP," XP"]}),e.jsx("div",{className:"text-gray-600 text-sm",children:"Total XP"})]}),e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsxs("div",{className:"font-bold text-orange-600 text-xl",children:[p.dailyStreak," hari"]}),e.jsx("div",{className:"text-gray-600 text-sm",children:"Streak Harian"})]})]})]})]})]})),"password"===r&&e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"Ubah Password"}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password Saat Ini"}),e.jsx("input",{type:"password",name:"currentPassword",value:h.currentPassword,onChange:w,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password Baru"}),e.jsx("input",{type:"password",name:"newPassword",value:h.newPassword,onChange:w,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md",required:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Minimal 6 karakter"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Konfirmasi Password Baru"}),e.jsx("input",{type:"password",name:"confirmPassword",value:h.confirmPassword,onChange:w,className:"mt-1 w-full px-3 py-2 border border-gray-300 rounded-md",required:!0})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md text-sm font-medium hover:bg-blue-700",disabled:o,children:o?"Memproses...":"Ubah Password"})})]})]}),"achievements"===r&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"Level Pengguna"}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-lg",children:p.rank}),e.jsxs("span",{className:"text-gray-500 ml-2",children:["(",p.totalXP," XP)"]})]}),e.jsx("div",{className:"text-gray-500",children:e.jsxs("span",{children:[p.xpToNextRank," XP lagi ke level ",p.nextRank]})})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:p.totalXP/(p.totalXP+p.xpToNextRank)*100+"%"}})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"Aktivitas Terbaru"}),e.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",children:e.jsx("ul",{className:"divide-y",children:p.recentActivities.length>0?p.recentActivities.map((a=>e.jsx("li",{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500",children:a.date})]}),e.jsx("div",{children:e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("quiz"===a.type?"bg-green-100 text-green-800":"flashcard"===a.type?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"),children:a.result})})]})},a.id))):e.jsx("li",{className:"p-4 text-center text-gray-500",children:"Belum ada aktivitas"})})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-4",children:"Topik Selesai"}),e.jsx("div",{className:"bg-white rounded-lg border overflow-hidden",children:e.jsx("ul",{className:"divide-y",children:p.topicsCompleted.length>0?p.topicsCompleted.map((a=>e.jsx("li",{className:"p-4 hover:bg-gray-50",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500",children:a.date})]}),e.jsx("div",{children:e.jsxs("span",{className:"text-blue-600 font-medium",children:["+",a.xpEarned," XP"]})})]})},a.id))):e.jsx("li",{className:"p-4 text-center text-gray-500",children:"Belum ada topik yang diselesaikan"})})})]})]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx(t,{to:"/dashboard",className:"text-blue-600 hover:text-blue-800",children:"← Kembali ke Dashboard"})})]})})};export{l as default};
